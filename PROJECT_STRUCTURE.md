# é¡¹ç›®ç»“æ„è¯´æ˜

```
card-shop-system/
â”‚
â”œâ”€â”€ ğŸ“ server/                      # åç«¯é¡¹ç›®
â”‚   â”œâ”€â”€ ğŸ“ config/                  # é…ç½®æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ database.js            # æ•°æ®åº“è¿æ¥é…ç½®
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ database/                # æ•°æ®åº“ç›¸å…³
â”‚   â”‚   â”œâ”€â”€ schema.sql             # æ•°æ®åº“è¡¨ç»“æ„
â”‚   â”‚   â””â”€â”€ test-data.sql          # æµ‹è¯•æ•°æ®
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ middleware/              # ä¸­é—´ä»¶
â”‚   â”‚   â””â”€â”€ auth.js                # èº«ä»½éªŒè¯ä¸­é—´ä»¶
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ routes/                  # è·¯ç”±ï¼ˆAPIæ¥å£ï¼‰
â”‚   â”‚   â”œâ”€â”€ auth.js                # è®¤è¯æ¥å£ï¼ˆæ³¨å†Œ/ç™»å½•ï¼‰
â”‚   â”‚   â”œâ”€â”€ products.js            # å•†å“æ¥å£
â”‚   â”‚   â”œâ”€â”€ orders.js              # è®¢å•æ¥å£
â”‚   â”‚   â”œâ”€â”€ payment.js             # æ”¯ä»˜æ¥å£
â”‚   â”‚   â”œâ”€â”€ users.js               # ç”¨æˆ·æ¥å£
â”‚   â”‚   â”œâ”€â”€ distribution.js        # åˆ†é”€æ¥å£
â”‚   â”‚   â””â”€â”€ admin.js               # ç®¡ç†å‘˜æ¥å£
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ utils/                   # å·¥å…·å‡½æ•°
â”‚   â”‚   â””â”€â”€ hash-password.js       # å¯†ç å“ˆå¸Œç”Ÿæˆå·¥å…·
â”‚   â”‚
â”‚   â””â”€â”€ index.js                   # åç«¯å…¥å£æ–‡ä»¶
â”‚
â”œâ”€â”€ ğŸ“ client/                      # å‰ç«¯é¡¹ç›®
â”‚   â”œâ”€â”€ ğŸ“ src/
â”‚   â”‚   â”œâ”€â”€ ğŸ“ api/                # API æ¥å£å°è£…
â”‚   â”‚   â”‚   â””â”€â”€ index.js          # æ‰€æœ‰ API æ¥å£
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ components/         # å…¬å…±ç»„ä»¶ï¼ˆå¯æ‰©å±•ï¼‰
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ layouts/            # å¸ƒå±€ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ MainLayout.vue    # å‰å°å¸ƒå±€
â”‚   â”‚   â”‚   â””â”€â”€ AdminLayout.vue   # åå°å¸ƒå±€
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ router/             # è·¯ç”±é…ç½®
â”‚   â”‚   â”‚   â””â”€â”€ index.js          # è·¯ç”±å®šä¹‰
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ store/              # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”‚   â””â”€â”€ user.js           # ç”¨æˆ·çŠ¶æ€
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ utils/              # å·¥å…·å‡½æ•°
â”‚   â”‚   â”‚   â””â”€â”€ request.js        # Axios å°è£…
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ views/              # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ Home.vue          # é¦–é¡µ
â”‚   â”‚   â”‚   â”œâ”€â”€ Login.vue         # ç™»å½•é¡µ
â”‚   â”‚   â”‚   â”œâ”€â”€ Register.vue      # æ³¨å†Œé¡µ
â”‚   â”‚   â”‚   â”œâ”€â”€ Products.vue      # å•†å“åˆ—è¡¨
â”‚   â”‚   â”‚   â”œâ”€â”€ ProductDetail.vue # å•†å“è¯¦æƒ…
â”‚   â”‚   â”‚   â”œâ”€â”€ OrderQuery.vue    # è®¢å•æŸ¥è¯¢
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ user/          # ç”¨æˆ·ä¸­å¿ƒ
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Index.vue     # ç”¨æˆ·ä¸­å¿ƒé¦–é¡µ
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Orders.vue    # æˆ‘çš„è®¢å•
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Distribution.vue # åˆ†é”€ä¸­å¿ƒ
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Withdraw.vue  # ç”³è¯·æç°
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“ admin/         # ç®¡ç†åå°
â”‚   â”‚   â”‚       â”œâ”€â”€ Dashboard.vue # æ•°æ®ç»Ÿè®¡
â”‚   â”‚   â”‚       â”œâ”€â”€ Products.vue  # å•†å“ç®¡ç†
â”‚   â”‚   â”‚       â”œâ”€â”€ Orders.vue    # è®¢å•ç®¡ç†
â”‚   â”‚   â”‚       â”œâ”€â”€ Users.vue     # ç”¨æˆ·ç®¡ç†
â”‚   â”‚   â”‚       â””â”€â”€ Withdrawals.vue # æç°ç®¡ç†
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ App.vue               # æ ¹ç»„ä»¶
â”‚   â”‚   â””â”€â”€ main.js               # å‰ç«¯å…¥å£
â”‚   â”‚
â”‚   â”œâ”€â”€ index.html                # HTML æ¨¡æ¿
â”‚   â”œâ”€â”€ vite.config.js            # Vite é…ç½®
â”‚   â””â”€â”€ package.json              # å‰ç«¯ä¾èµ–
â”‚
â”œâ”€â”€ ğŸ“„ .env.example                # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ ğŸ“„ .gitignore                  # Git å¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ ğŸ“„ package.json                # åç«¯ä¾èµ–
â”‚
â”œâ”€â”€ ğŸ“„ README.md                   # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ ğŸ“„ QUICKSTART.md               # å¿«é€Ÿå¼€å§‹
â”œâ”€â”€ ğŸ“„ LOCAL_DEBUG.md              # æœ¬åœ°è°ƒè¯•æŒ‡å—
â”œâ”€â”€ ğŸ“„ INSTALL.md                  # éƒ¨ç½²æŒ‡å—
â”œâ”€â”€ ğŸ“„ API.md                      # API æ–‡æ¡£
â”œâ”€â”€ ğŸ“„ PROJECT_STRUCTURE.md        # é¡¹ç›®ç»“æ„ï¼ˆæœ¬æ–‡ä»¶ï¼‰
â”‚
â”œâ”€â”€ ğŸ”§ init-db.bat                 # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬ï¼ˆWindowsï¼‰
â”œâ”€â”€ ğŸ”§ init-db.sh                  # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬ï¼ˆMac/Linuxï¼‰
â”œâ”€â”€ ğŸ”§ start.bat                   # å¯åŠ¨è„šæœ¬ï¼ˆWindowsï¼‰
â”œâ”€â”€ ğŸ”§ start.sh                    # å¯åŠ¨è„šæœ¬ï¼ˆMac/Linuxï¼‰
â”œâ”€â”€ ğŸ”§ test-import.bat             # æµ‹è¯•æ•°æ®å¯¼å…¥è„šæœ¬
â””â”€â”€ ğŸ”§ package-lock-fix.bat        # ä¾èµ–ä¿®å¤è„šæœ¬
```

## æ ¸å¿ƒæ–‡ä»¶è¯´æ˜

### åç«¯æ ¸å¿ƒæ–‡ä»¶

#### `server/index.js`
- åç«¯å…¥å£æ–‡ä»¶
- é…ç½® Express æœåŠ¡å™¨
- æ³¨å†Œæ‰€æœ‰è·¯ç”±
- é”™è¯¯å¤„ç†

#### `server/config/database.js`
- MySQL è¿æ¥æ± é…ç½®
- æ•°æ®åº“è¿æ¥ç®¡ç†

#### `server/middleware/auth.js`
- JWT èº«ä»½éªŒè¯ä¸­é—´ä»¶
- ç®¡ç†å‘˜æƒé™éªŒè¯

#### `server/routes/`
æ‰€æœ‰ API æ¥å£çš„å®ç°ï¼š
- **auth.js** - ç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€JWT ç”Ÿæˆ
- **products.js** - å•†å“åˆ—è¡¨ã€è¯¦æƒ…ã€åˆ†ç±»
- **orders.js** - åˆ›å»ºè®¢å•ã€æŸ¥è¯¢è®¢å•
- **payment.js** - æ”¯ä»˜åˆ›å»ºã€æ”¯ä»˜å›è°ƒã€ä½£é‡‘ç»“ç®—
- **users.js** - ç”¨æˆ·ä¿¡æ¯ã€æç°ç”³è¯·
- **distribution.js** - åˆ†é”€ç»Ÿè®¡ã€ä½£é‡‘è®°å½•ã€å›¢é˜Ÿç®¡ç†
- **admin.js** - ç®¡ç†åå°æ‰€æœ‰åŠŸèƒ½

### å‰ç«¯æ ¸å¿ƒæ–‡ä»¶

#### `client/src/main.js`
- å‰ç«¯å…¥å£æ–‡ä»¶
- æ³¨å†Œ Vue æ’ä»¶
- æŒ‚è½½åº”ç”¨

#### `client/src/router/index.js`
- è·¯ç”±é…ç½®
- è·¯ç”±å®ˆå«ï¼ˆæƒé™éªŒè¯ï¼‰

#### `client/src/store/user.js`
- ç”¨æˆ·çŠ¶æ€ç®¡ç†
- Token å­˜å‚¨
- ç™»å½•/ç™»å‡ºé€»è¾‘

#### `client/src/utils/request.js`
- Axios å°è£…
- è¯·æ±‚/å“åº”æ‹¦æˆªå™¨
- è‡ªåŠ¨æ·»åŠ  Token
- é”™è¯¯å¤„ç†

#### `client/src/api/index.js`
- æ‰€æœ‰ API æ¥å£çš„å°è£…
- ç»Ÿä¸€çš„æ¥å£è°ƒç”¨æ–¹å¼

#### `client/src/layouts/`
- **MainLayout.vue** - å‰å°å¸ƒå±€ï¼ˆå¯¼èˆªæ ã€é¡µè„šï¼‰
- **AdminLayout.vue** - åå°å¸ƒå±€ï¼ˆä¾§è¾¹æ ã€é¡¶æ ï¼‰

#### `client/src/views/`
æ‰€æœ‰é¡µé¢ç»„ä»¶ï¼ŒæŒ‰åŠŸèƒ½æ¨¡å—ç»„ç»‡

### æ•°æ®åº“æ–‡ä»¶

#### `server/database/schema.sql`
å®Œæ•´çš„æ•°æ®åº“è¡¨ç»“æ„ï¼š
- users - ç”¨æˆ·è¡¨
- categories - åˆ†ç±»è¡¨
- products - å•†å“è¡¨
- cards - å¡å¯†è¡¨
- orders - è®¢å•è¡¨
- commissions - ä½£é‡‘è®°å½•è¡¨
- withdrawals - æç°è®°å½•è¡¨
- settings - ç³»ç»Ÿé…ç½®è¡¨

#### `server/database/test-data.sql`
æµ‹è¯•æ•°æ®ï¼ŒåŒ…å«ï¼š
- 4ä¸ªå•†å“åˆ†ç±»
- 10ä¸ªæµ‹è¯•å•†å“
- 50å¼ æµ‹è¯•å¡å¯†
- 3ä¸ªæµ‹è¯•ç”¨æˆ·

## æ•°æ®æµå‘

### ç”¨æˆ·è´­ä¹°æµç¨‹

```
ç”¨æˆ·æµè§ˆå•†å“
    â†“
é€‰æ‹©å•†å“å¹¶ä¸‹å•
    â†“
åˆ›å»ºè®¢å•ï¼ˆPOST /api/orders/createï¼‰
    â†“
é€‰æ‹©æ”¯ä»˜æ–¹å¼
    â†“
è·³è½¬æ”¯ä»˜é¡µé¢ï¼ˆPOST /api/payment/createï¼‰
    â†“
æ”¯ä»˜æˆåŠŸå›è°ƒï¼ˆPOST /api/payment/notifyï¼‰
    â†“
è‡ªåŠ¨åˆ†é…å¡å¯†
    â†“
è®¡ç®—å¹¶å‘æ”¾ä½£é‡‘
    â†“
ç”¨æˆ·æŸ¥çœ‹è®¢å•å’Œå¡å¯†
```

### åˆ†é”€ä½£é‡‘æµç¨‹

```
ç”¨æˆ·Aæ³¨å†Œï¼ˆå¸¦é‚€è¯·ç ï¼‰
    â†“
è®°å½•æ¨èå…³ç³»ï¼ˆparent_id, grandparent_idï¼‰
    â†“
ç”¨æˆ·Aè´­ä¹°å•†å“å¹¶æ”¯ä»˜
    â†“
ç³»ç»Ÿè‡ªåŠ¨è®¡ç®—ä½£é‡‘
    â†“
ä¸€çº§æ¨èäººè·å¾— 10% ä½£é‡‘
    â†“
äºŒçº§æ¨èäººè·å¾— 5% ä½£é‡‘
    â†“
ä½£é‡‘è‡ªåŠ¨åˆ°è´¦ä½™é¢
    â†“
ç”¨æˆ·å¯ç”³è¯·æç°
```

## æŠ€æœ¯æ¶æ„

### åç«¯æŠ€æœ¯æ ˆ
- **æ¡†æ¶**: Express.js
- **æ•°æ®åº“**: MySQL
- **è®¤è¯**: JWT (jsonwebtoken)
- **å¯†ç åŠ å¯†**: bcryptjs
- **HTTP å®¢æˆ·ç«¯**: axiosï¼ˆç”¨äºæ”¯ä»˜æ¥å£ï¼‰

### å‰ç«¯æŠ€æœ¯æ ˆ
- **æ¡†æ¶**: Vue 3
- **æ„å»ºå·¥å…·**: Vite
- **UI ç»„ä»¶**: Element Plus
- **çŠ¶æ€ç®¡ç†**: Pinia
- **è·¯ç”±**: Vue Router
- **HTTP å®¢æˆ·ç«¯**: Axios

## æ‰©å±•å»ºè®®

### åŠŸèƒ½æ‰©å±•
1. **é‚®ä»¶é€šçŸ¥** - å®‰è£… nodemailerï¼Œè®¢å•å®Œæˆåå‘é€é‚®ä»¶
2. **çŸ­ä¿¡é€šçŸ¥** - å¯¹æ¥çŸ­ä¿¡æœåŠ¡å•†
3. **å›¾ç‰‡ä¸Šä¼ ** - å¯¹æ¥ OSS å­˜å‚¨
4. **æ•°æ®ç»Ÿè®¡** - æ·»åŠ æ›´è¯¦ç»†çš„æ•°æ®åˆ†æ
5. **ä¼˜æƒ åˆ¸ç³»ç»Ÿ** - æ·»åŠ ä¼˜æƒ åˆ¸åŠŸèƒ½
6. **ç§¯åˆ†ç³»ç»Ÿ** - ç”¨æˆ·ç§¯åˆ†å’Œå…‘æ¢

### æ€§èƒ½ä¼˜åŒ–
1. **Redis ç¼“å­˜** - ç¼“å­˜çƒ­é—¨å•†å“å’Œç”¨æˆ·ä¿¡æ¯
2. **CDN åŠ é€Ÿ** - é™æ€èµ„æºä½¿ç”¨ CDN
3. **æ•°æ®åº“ä¼˜åŒ–** - æ·»åŠ ç´¢å¼•ã€æŸ¥è¯¢ä¼˜åŒ–
4. **è´Ÿè½½å‡è¡¡** - ä½¿ç”¨ Nginx è´Ÿè½½å‡è¡¡

### å®‰å…¨åŠ å›º
1. **é™æµ** - æ·»åŠ æ¥å£é™æµ
2. **éªŒè¯ç ** - ç™»å½•å’Œæ³¨å†Œæ·»åŠ éªŒè¯ç 
3. **SQL æ³¨å…¥é˜²æŠ¤** - ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢
4. **XSS é˜²æŠ¤** - è¾“å…¥è¿‡æ»¤å’Œè¾“å‡ºè½¬ä¹‰

## å¼€å‘è§„èŒƒ

### ä»£ç é£æ ¼
- ä½¿ç”¨ ES6+ è¯­æ³•
- ç»Ÿä¸€ä½¿ç”¨ 2 ç©ºæ ¼ç¼©è¿›
- å˜é‡å‘½åä½¿ç”¨é©¼å³°å‘½åæ³•
- å¸¸é‡ä½¿ç”¨å¤§å†™ä¸‹åˆ’çº¿å‘½å

### Git æäº¤è§„èŒƒ
```
feat: æ–°åŠŸèƒ½
fix: ä¿®å¤ bug
docs: æ–‡æ¡£æ›´æ–°
style: ä»£ç æ ¼å¼è°ƒæ•´
refactor: é‡æ„
test: æµ‹è¯•ç›¸å…³
chore: æ„å»º/å·¥å…·ç›¸å…³
```

### API è®¾è®¡è§„èŒƒ
- RESTful é£æ ¼
- ç»Ÿä¸€çš„å“åº”æ ¼å¼
- åˆç†çš„ HTTP çŠ¶æ€ç 
- è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯

## å¸¸ç”¨å‘½ä»¤

```bash
# å¼€å‘
npm run dev              # åŒæ—¶å¯åŠ¨å‰åç«¯
npm run server           # åªå¯åŠ¨åç«¯
npm run client           # åªå¯åŠ¨å‰ç«¯

# å®‰è£…
npm run install-all      # å®‰è£…æ‰€æœ‰ä¾èµ–

# æ„å»º
cd client && npm run build  # æ„å»ºå‰ç«¯

# æ•°æ®åº“
mysql -u root -p < server/database/schema.sql      # å¯¼å…¥è¡¨ç»“æ„
mysql -u root -p < server/database/test-data.sql   # å¯¼å…¥æµ‹è¯•æ•°æ®

# å·¥å…·
node server/utils/hash-password.js å¯†ç   # ç”Ÿæˆå¯†ç å“ˆå¸Œ
```

## ç›®å½•å‘½åè§„èŒƒ

- ğŸ“ æ–‡ä»¶å¤¹ä½¿ç”¨å°å†™å­—æ¯ï¼Œå¤šä¸ªå•è¯ç”¨è¿å­—ç¬¦åˆ†éš”
- ğŸ“„ Vue ç»„ä»¶ä½¿ç”¨ PascalCaseï¼ˆå¤§é©¼å³°ï¼‰
- ğŸ“„ JavaScript æ–‡ä»¶ä½¿ç”¨ kebab-caseï¼ˆçŸ­æ¨ªçº¿ï¼‰
- ğŸ“„ é…ç½®æ–‡ä»¶ä½¿ç”¨å°å†™å­—æ¯

## æ›´å¤šä¿¡æ¯

- æŸ¥çœ‹ [API.md](API.md) äº†è§£è¯¦ç»†çš„æ¥å£æ–‡æ¡£
- æŸ¥çœ‹ [LOCAL_DEBUG.md](LOCAL_DEBUG.md) äº†è§£è°ƒè¯•æŠ€å·§
- æŸ¥çœ‹ [INSTALL.md](INSTALL.md) äº†è§£éƒ¨ç½²æ–¹æ³•
